# 🕘 個人化打卡系統使用說明

## 概述
Niibot 打卡系統已完全升級為個人化系統，每個用戶可以設定自己的上班時間和工時，系統會自動提醒打卡。舊版群組設定系統已整合並移除，現在完全採用個人化架構。

## 🚀 快速開始

### 1. 初次設定
```
/pclock
```
系統會彈出設定Modal，包含：
- **上班時間**: 例如 `08:30`
- **工作時數**: 例如 `8.0`
- **彈性打卡**: 輸入 `是` 啟用，`否` 關閉
- **彈性時間**: 彈性模式下的時間窗口（分鐘）

### 2. 查看狀態
```
/pstatus
```
查看個人工作狀態和設定

### 3. 緊急手動打卡
```
/pclock_manual
```
當自動提醒失效時使用

## 🎯 核心功能

### 自動提醒系統
- 系統每分鐘檢查，在設定的上班時間自動彈出打卡界面
- 工時達標時自動提醒下班
- 支援@提及用戶

### 彈性打卡模式
- **定點模式**（預設）：08:30 準時打卡，08:31 即遲到
- **彈性模式**：08:30-09:00 彈性區間，09:01 才算遲到

### 智能界面
- **上班界面**：30分鐘超時，支援重新整理
- **下班界面**：15分鐘超時，顯示詳細工時
- **美觀排版**：統一色彩系統，清晰資訊層次

## 📊 數據管理

### 個人檔案
每個用戶有獨立的JSON檔案：
```
data/clock_users/clock_user_{user_id}.json
```

### 資料結構
- **用戶資訊**：設定完成狀態、建立時間
- **個人設定**：時間、工時、彈性模式等
- **活躍會話**：當前工作狀態
- **每日記錄**：打卡歷史、工時統計

## 🔧 技術特色

### 架構設計
- **模組化**：PersonalClockCore、PersonalClockSettings 分離職責
- **向後相容**：保留原有Clock V2功能
- **擴展性**：支援未來週/月統計功能

### 安全性
- **輸入驗證**：時間格式、數值範圍檢查
- **錯誤處理**：完整的異常捕獲和日誌記錄
- **權限控制**：只有本人能操作自己的打卡界面

## 📈 使用流程示例

1. **初次使用**：
   ```
   用戶: /pclock
   系統: 彈出設定Modal
   用戶: 填寫設定並提交
   系統: 顯示設定完成界面
   ```

2. **日常使用**：
   ```
   08:30 → 系統自動@用戶並彈出打卡界面
   用戶: 點擊[🟢 立即打卡]
   系統: 顯示打卡成功訊息
   17:30 → 系統自動提醒下班
   用戶: 點擊[🕕 下班打卡]
   系統: 顯示工時統計
   ```

## 🎪 優勢特色

✅ **完全自動化** - 設定一次，終身受益
✅ **個人化設定** - 每人獨立時間和工時
✅ **彈性友善** - 支援彈性打卡模式
✅ **美觀界面** - 統一設計語言
✅ **準確計算** - 精確的遲到判定
✅ **數據完整** - 完整的工時記錄
✅ **向後相容** - 不影響現有功能

## 🔄 系統升級變更

### 重大更新
✅ **統一架構** - 移除舊版群組設定系統，完全採用個人化架構  
✅ **向後相容** - 舊指令 `?clock`, `?status` 已重新導向到新系統  
✅ **簡化管理** - 不再需要管理員設定，每位用戶自主管理  
✅ **數據整合** - 舊數據已清理，使用統一的個人檔案系統  

### 指令對照表
| 舊指令 | 新指令 | 功能 |
|--------|--------|------|
| `?clock` | `/pclock_manual` | 手動打卡 |
| `?status` | `/pstatus` | 查看狀態 |
| `?clockadmin` | 已移除 | 不再需要管理員設定 |
| - | `/pclock` | 個人設定（新增） |

### 遷移指南
1. 使用 `/pclock` 完成個人設定
2. 舊指令會自動引導到新系統
3. 享受完全個人化的打卡體驗